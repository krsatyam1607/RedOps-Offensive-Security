import argparse
import subprocess

# --- SQLMap Integration ---
def run_sqlmap(url, param=None, outdir='reports/exploits', headers=None):
    print("[*] Running SQLMap...")

    cmd = [
        "sqlmap",
        "-u", url,
        "--batch",
        "--output-dir", outdir
    ]

    if param:
        cmd += ["-p", param]

    if headers:
        cmd += ["--headers", headers]

    subprocess.run(cmd)

# --- Argument Parser & Main ---
def main():
    parser = argparse.ArgumentParser(description="RedOps Exploit Engine - SQL Injection Module")
    parser.add_argument("-u", "--url", required=True, help="Target URL")
    parser.add_argument("-m", "--mode", choices=["sqlmap"], required=True, help="Exploit type")
    parser.add_argument("-p", "--param", help="Parameter to test")
    parser.add_argument("-o", "--outdir", default="reports/exploits", help="Output directory")
    parser.add_argument("-H", "--headers", help="Custom headers (e.g., cookies)", default=None)

    args = parser.parse_args()

    if args.mode == "sqlmap":
        run_sqlmap(args.url, param=args.param, outdir=args.outdir, headers=args.headers)

if __name__ == "__main__":
    main()
